"use strict";(self.webpackChunkegoexo_docs=self.webpackChunkegoexo_docs||[]).push([[809],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>u});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},m=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),c=p(n),h=r,u=c["".concat(l,".").concat(h)]||c[h]||d[h]||o;return n?a.createElement(u,i(i({ref:t},m),{},{components:n})):a.createElement(u,i({ref:t},m))}));function u(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[c]="string"==typeof e?e:r,i[1]=s;for(var p=2;p<o;p++)i[p]=n[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},5695:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var a=n(7462),r=(n(7294),n(3905));const o={title:"Expert Commentary",sidebar_position:6},i=void 0,s={unversionedId:"annotations/expert_commentary",id:"annotations/expert_commentary",title:"Expert Commentary",description:"- To download transcriptions use --parts annotations. You can use --benchmarks expert_commentary to filter for just the transcription file.",source:"@site/docs/annotations/expert_commentary.md",sourceDirName:"annotations",slug:"/annotations/expert_commentary",permalink:"/annotations/expert_commentary",draft:!1,tags:[],version:"current",sidebarPosition:6,frontMatter:{title:"Expert Commentary",sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"Atomic Action Descriptions",permalink:"/annotations/atomic_descriptions"},next:{title:"Benchmarks",permalink:"/benchmarks/"}},l={},p=[{value:"Annotations Structure",id:"annotations-structure",level:2},{value:"First Form Structure (<code>expert_commentary_&lt;split&gt;.json</code>)",id:"first-form-structure-expert_commentary_splitjson",level:3},{value:"Sample JSON",id:"sample-json",level:4},{value:"Second Form Structure (folder per annotation instance)",id:"second-form-structure-folder-per-annotation-instance",level:3}],m={toc:p},c="wrapper";function d(e){let{components:t,...n}=e;return(0,r.kt)(c,(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"To download transcriptions use ",(0,r.kt)("inlineCode",{parentName:"li"},"--parts annotations"),". You can use ",(0,r.kt)("inlineCode",{parentName:"li"},"--benchmarks expert_commentary")," to filter for just the transcription file."),(0,r.kt)("li",{parentName:"ul"},"To download all data for expert commentary use ",(0,r.kt)("inlineCode",{parentName:"li"},"--parts expert_commentary")," (and ",(0,r.kt)("inlineCode",{parentName:"li"},"--parts annotations")," for train/val split transcription file)"))),(0,r.kt)("h1",{id:"expert-commentary"},"Expert Commentary"),(0,r.kt)("p",null,"Please refer to the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/facebookresearch/Ego4d/blob/main/notebooks/egoexo/EgoExo_Expert_Commentary_Tutorial.ipynb"},"Jupyter notebook tutorial")," for an overview and how to use the available annotation files."),(0,r.kt)("p",null,"We enlist subject domain experts (e.g. professional chefs, coaches, performers) to provide commentary on the takes in our dataset. Unlike prior datasets, which primarily focus on ",(0,r.kt)("em",{parentName:"p"},"what")," is happening, expert commentary additionally provides insights on the ",(0,r.kt)("em",{parentName:"p"},"why")," of the demonstration, and ",(0,r.kt)("em",{parentName:"p"},"how well")," the demonstration is performed."),(0,r.kt)("p",null,"Each take may be commentated on by several different in-domain experts, each of whom may have different styles or aspects they prioritize; the expert providing a particular commentary is identifiable by a unique 6 character ID. "),(0,r.kt)("p",null,"The expert commentary consists of three types of data:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"Commentaries"),": As experts watch each take, they pause the video as desired to record verbal commentary. Experts were instructed to keep commentaries retrospective -- i.e. they should not reference events that happen after the frame on which they've paused. We provide both the video timestamp when the expert paused the video, as well as the order in which the commentaries were recorded. We provide both the original audio recordings, as well as auto-transcriptions ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/facebookresearch/Ego4d/blob/main/ego4d/internal/expert_commentary/transcribe.py#L19-L45"},"using Whisper"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"Spatial drawings"),": For each commentary, experts were given the option to draw on the video player to provide visual grounding to their comments. When available, we provide the stroke paths as a temporal sequence of pixel coordinates."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"Proficiency"),": After watching each take, experts provided a single proficiency score to the entire demonstration on a scale from 1-10. Experts were encouraged to utilize the full dynamic range across all the takes they viewed, but were otherwise given the freedom to define the scaling themselves.")),(0,r.kt)("h2",{id:"annotations-structure"},"Annotations Structure"),(0,r.kt)("p",null,"The annotations for Expert Commentary are present in two forms:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"An aggregation of all of the commentary transcriptions in a single JSON file (per train/val split)",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Available via ",(0,r.kt)("inlineCode",{parentName:"li"},"--parts annotations --benchmarks expert_commentary")," (note the ",(0,r.kt)("inlineCode",{parentName:"li"},"--benchmarks")," flag is optional)"))),(0,r.kt)("li",{parentName:"ol"},"A separate directory containing all the audio recordings and metadata associated to a particular annotation instance from an expert annotator.",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Available via ",(0,r.kt)("inlineCode",{parentName:"li"},"--parts expert_commentary"))))),(0,r.kt)("p",null,"The first form only contains transcriptions of the commentaries. The second\nform in addition to containing transcriptions, contains the audio recordings,\nspatial drawing data and the proficiency score (and reason why) per annotation\ninstance."),(0,r.kt)("p",null,"The second form is significantly larger than the first in terms of file size,\nwhich is one of the reasons why the annotations are structured into two parts.\nThe other reason for having the first form is convenience: it serves as an easy\nto use index to the second form, i.e. just by reading one file you can get a\nlist of all the commentaries present for one of the train/avl splits."),(0,r.kt)("h3",{id:"first-form-structure-expert_commentary_splitjson"},"First Form Structure (",(0,r.kt)("inlineCode",{parentName:"h3"},"expert_commentary_<split>.json"),")"),(0,r.kt)("p",null,"We transcribe each annotation and aggregate these transcriptions into a single\nJSON file per split (",(0,r.kt)("inlineCode",{parentName:"p"},"--parts annotations"),"). The test set is redacted due to\nthe ",(0,r.kt)("a",{parentName:"p",href:"/benchmarks/proficiency_estimation/"},"Proficiency benchmark task"),". This\nsingle annotation file (per split) does not include spatial drawing data or\nproficiency information, but can be used to refer to the more granular\nannotation data as described below."),(0,r.kt)("h4",{id:"sample-json"},"Sample JSON"),(0,r.kt)("p",null,"Here is a JSON snippet showing a sample annotation from the ",(0,r.kt)("inlineCode",{parentName:"p"},"expert_commentary_<split>.json")," file:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n   "ds": "YYYYDDMM_HH:MM:SS", # when the data was exported\n   "annotations": {\n       "<take_uid1>": [\n           {\n               // take identifiers\n               "take_name": "cmu_bike15_4",\n               "take_uid": "816c4bd2-a5ba-4e40-854f-c98d771d1060",\n\n               // task information for the take\n               "task_id": 4004,\n               "task_name": "Clean and Lubricate the Chain",\n\n               // where the commentary is located relative to annotations/expert_commentary/\n               "commentary": "cmu_bike15_4/qfbn5o", // last 6 characters (after the slash) is the expert\'s uid\n               "commentary_data": [\n                   {\n                       "recording": "4.webm", // associated audio file\n                        // where in the video the commentary was made\n                       "video_time": 27.833885,\n\n                       // a transcription of the commentary\n                       "text": " Our mechanic is using a 15mm ratcheting combination wrench, which will be a great tool for the job and will make this job quicker and more efficient.",\n                       // how long the audio recording is (approximately)\n                       "duration_approx": 12.76620000000298\n\n                        // whether there was an error transcribing the audio\n                        "error": false,\n                   },\n                    ...\n                ]\n            }\n            ...\n        ]\n        "<take_uid2>": [ ... ],\n        ...\n    }\n}\n')),(0,r.kt)("h3",{id:"second-form-structure-folder-per-annotation-instance"},"Second Form Structure (folder per annotation instance)"),(0,r.kt)("p",null,"For audio recordings, proficiency and spatial drawing data, you will need to refer to the ",(0,r.kt)("inlineCode",{parentName:"p"},"expert_commentary")," folder under the ",(0,r.kt)("inlineCode",{parentName:"p"},"annotations")," folder (you will need to download with ",(0,r.kt)("inlineCode",{parentName:"p"},"--parts expert_commentary"),"). To read the spatial drawing correctly, please refer to the function ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/facebookresearch/Ego4d/blob/main/ego4d/egoexo/expert_commentary.py#L4"},(0,r.kt)("inlineCode",{parentName:"a"},"get_paths_for_commentary_time"))," in the python module ",(0,r.kt)("inlineCode",{parentName:"p"},"ego4d.egoexo.expert_commentary")," (example usage is shown in the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/facebookresearch/Ego4d/blob/main/notebooks/egoexo/EgoExo_Expert_Commentary_Tutorial.ipynb"},"tutorial notebook"),")."),(0,r.kt)("p",null,"This folder is structured as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"|-- annotations/expert_commentary\n    |-- [take_name]\n        |-- [expert_uid]\n            |-- recordings\n                |-- 0.webm\n                |-- 1.webm\n                ...\n            |-- data.json\n            |-- transcriptions.json\n        |-- [expert_uid]\n            ...\n    |-- [take_name]\n    ...\n")),(0,r.kt)("p",null,"The contents under each ",(0,r.kt)("inlineCode",{parentName:"p"},"annotations/expert_commentary/[take_name]/[expert_uid]")," directory comprise an expert commentary annotation, consisting of the following files:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"recordings/[x].webm"),": Audio recordings of a commentary. Here ","[x]"," encodes the order in which the recordings were recorded, in real time. Experts"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"data.json"),": Contains expert commentary metadata, spatial drawing paths, and proficiency score/explanations. Some of the more relevant fields:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"user_id"),": The 6 character unique ID of the expert providing the commentary"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"video_name"),": The video name of the take commentated on by the expert."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"annotations"),": A list, containing information per commentary"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"recording_path"),": Name of the corresponding recording file (",(0,r.kt)("inlineCode",{parentName:"li"},"[x].webm"),")"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"duration_approx"),": Length of the recording in seconds"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"video_time"),": Timestamp in the video when the expert paused, to provide commentary"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"events"),": Data for reconstruction the spatial drawings. The ",(0,r.kt)("inlineCode",{parentName:"li"},"paths")," field contains pairs of data points, whose ",(0,r.kt)("inlineCode",{parentName:"li"},"from")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"to")," fields provide the (x,y) coordinates and timestamps of the start and end of each stroke."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"proficiency"),": Demonstration proficiency information"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"rating"),": A score from 1-10"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"why"),": A short text explanation of why the ",(0,r.kt)("inlineCode",{parentName:"li"},"rating")," was chosen"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"transcriptions.json"),": Auto-transcriptions of the recordings files, using Whisper. Note that these may contain errors, as auto-transcriptions may not be perfect. Each entry in the transcription file is indexed by the recording file name (",(0,r.kt)("inlineCode",{parentName:"li"},"[x].webm"),"), with the following fields:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"text"),": The text of the transcription"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"language"),": The language code of the transcription. All our experts are native English speakers, so this should be ",(0,r.kt)("inlineCode",{parentName:"li"},"en")," for all transcriptions."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"error"),": a boolean flag to mark whether there was an error"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"error_desc"),": A description of the error if ",(0,r.kt)("inlineCode",{parentName:"li"},"error")," is ",(0,r.kt)("inlineCode",{parentName:"li"},"true")," (",(0,r.kt)("inlineCode",{parentName:"li"},"traceback.format_exc()"),") "),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"NOTE:")," this file is aggregated into the first form, i.e. you do not need to read this file if you are reading the first form's file.")))))}d.isMDXComponent=!0}}]);